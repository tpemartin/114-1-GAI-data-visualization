<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>平均每戶合計金額｜前15 & 後15</title>
  <style>
    body{font-family: system-ui, -apple-system, 'Noto Sans TC', 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:24px; line-height:1.5;}
    h1{font-size:1.5rem; margin:0 0 8px;}
    .note{color:#555; margin-bottom:16px;}
    .grid{display:grid; grid-template-columns: 1fr; gap:28px; max-width:1200px;}
    @media(min-width:1000px){
      .grid{grid-template-columns:1fr 1fr;}
    }
    .card{border:1px solid #e5e7eb; border-radius:12px; padding:16px; box-shadow:0 1px 6px rgba(0,0,0,.05);}
    canvas{max-height:800px;}
    footer{margin-top:24px; font-size:.9rem; color:#666;}
    code{background:#f6f8fa; padding:2px 6px; border-radius:6px;}
  </style>
</head>
<body>
  <h1>平均每戶合計金額（合計 ÷ 納稅單位）</h1>
  <div class="note">資料檔：111_166-F.csv；單位依原始資料。產生時間：2025-09-24T02:45:59.286518</div>
  <div class="grid">
    <section class="card">
      <h2>最高前 15 名（區里）</h2>
      <canvas id="topChart"></canvas>
    </section>
    <section class="card">
      <h2>最低 15 名（區里）</h2>
      <canvas id="botChart"></canvas>
    </section>
  </div>
  <footer>
    計算方式：<code>合計 ÷ 納稅單位(戶)</code>；本資料僅含「縣市別、村里」，無單獨「區」欄位，故以里為單位顯示。
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script>
    const labelsTop = ["新北市淡水區 民安里", "新北市新店區 下城里", "新北市鶯歌區 其他", "新北市板橋區 福丘里", "新北市新店區 華城里", "新北市板橋區 挹秀里", "新北市新店區 長春里", "新北市新店區 寶興里", "新北市五股區 德泰里", "新北市新店區 中山里", "新北市板橋區 深丘里", "新北市板橋區 景星里", "新北市新店區 中央里", "新北市林口區 南勢里", "新北市汐止區 長青里"];
    const valuesTop = [2985.89, 2858.2, 2354.0, 2280.79, 2180.04, 2165.41, 1947.05, 1921.13, 1845.27, 1817.14, 1767.99, 1672.49, 1659.26, 1625.83, 1515.79];
    const labelsBot = ["新北市林口區 其他", "新北市三峽區 其他", "新北市烏來區 其他", "新北市石碇區 其他", "新北市新莊區 其他", "新北市永和區 其他", "新北市三芝區 八賢里", "新北市瑞芳區 濓新里", "新北市瑞芳區 南雅里", "新北市瑞芳區 崇文里", "新北市深坑區 其他", "新北市平溪區 白石里", "新北市平溪區 菁桐里", "新北市平溪區 薯榔里", "新北市雙溪區 共和里"];
    const valuesBot = [99.0, 209.0, 218.0, 229.0, 334.5, 342.5, 351.12, 376.63, 388.39, 398.04, 414.4, 443.96, 445.9, 453.39, 453.51];

    function makeHorizontalBar(ctx, labels, data, title){
      return new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [{
            label: title,
            data,
            borderWidth: 1
          }]
        },
        options: {
          indexAxis: 'y',
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              ticks: { callback: (v) => v.toLocaleString() },
              title: { display: true, text: '平均每戶合計金額' }
            },
            y: {
              ticks: { autoSkip: false, maxTicksLimit: 20 }
            }
          },
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: (ctx) => ' ' + ctx.parsed.x.toLocaleString()
              }
            }
          }
        }
      });
    }

    const topCtx = document.getElementById('topChart').getContext('2d');
    const botCtx = document.getElementById('botChart').getContext('2d');
    makeHorizontalBar(topCtx, labelsTop, valuesTop, 'Top 15');
    makeHorizontalBar(botCtx, labelsBot, valuesBot, 'Bottom 15');
  </script>
</body>
</html>